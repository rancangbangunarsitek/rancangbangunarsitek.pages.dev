jQuery(document).ready(function(v){function e(){var e=v(document).find("[data-pafe-form-builder-preview-submission]");0<e.length&&e.each(function(){var h=v(this).attr("data-pafe-form-builder-preview-submission"),e=v(document).find("[data-pafe-form-builder-form-id="+h+"]"),b=[],a=new FormData,t=v(this);t.closest(".madxartwork-element");e.each(function(){if(null==v(this).data("pafe-form-builder-stripe")&&null==v(this).data("pafe-form-builder-html")){var e=v(this).closest(".madxartwork-field-type-checkbox.madxartwork-field-required");0<e.length&&e.find("input[type=checkbox]:checked").length,v(this).closest(".madxartwork-field-group").find("[data-pafe-form-builder-required]").html("");var a,t,r=v(this).attr("type"),l=v(this).attr("name"),i=v(this).closest("[data-pafe-form-builder-repeater-form-id]"),d="",n="",s="",o=-1,e=0;if(0<i.length&&($repeaterParents=v(this).parents("[data-pafe-form-builder-repeater-form-id]"),n=i.data("pafe-form-builder-repeater-id"),$repeaterParents.each(function(){var e=v(this).data("pafe-form-builder-repeater-id"),a=v(document).find('[data-pafe-form-builder-repeater-form-id="'+h+'"][data-pafe-form-builder-repeater-id="'+e+'"]');repeaterParentIndex=v(this).index()-a.index(),d+=e+"|index"+repeaterParentIndex+"|"+l.replace("[]","").replace("form_fields[","").replace("]","")+","}),s=i.data("pafe-form-builder-repeater-label"),t=v(document).find('[data-pafe-form-builder-repeater-id="'+i.data("pafe-form-builder-repeater-id")+'"]'),e=i.siblings('[data-pafe-form-builder-repeater-id="'+i.data("pafe-form-builder-repeater-id")+'"]').length+1,o=i.index()-t.index()),-1!==l.indexOf("[]")){var f=[];"checkbox"==r?v(this).closest(".madxartwork-element").find('[name="'+l+'"]:checked').each(function(){f.push(v(this).val())}):null==(f=v(this).val())&&(f=[]);for(var p,m,u=a="",c=0;c<f.length;c++)null!=v(this).data("pafe-form-builder-send-data-by-label")&&(p=f[c],"checkbox"==r?0<(m=v(this).closest(".madxartwork-element").find('[value="'+p+'"]')).length&&(u+=m.data("pafe-form-builder-send-data-by-label")+","):0<(m=v(this).find('[value="'+p+'"]')).length&&(u+=m.html()+",")),a+=f[c]+",";a=a.replace(/,(\s+)?$/,"")}else a="radio"==r||"checkbox"==r?(null!=v(this).data("pafe-form-builder-send-data-by-label")&&(u=v(this).closest(".madxartwork-element").find('[name="'+l+'"]:checked').data("pafe-form-builder-send-data-by-label")),v(this).closest(".madxartwork-element").find('[name="'+l+'"]:checked').val()):null!=v(this).data("pafe-form-builder-calculated-fields")?v(this).siblings(".pafe-calculated-fields-form").text():(null!=v(this).data("pafe-form-builder-send-data-by-label")&&(p=v(this).val().trim(),0<(m=v(this).find('[value="'+p+'"]')).length&&(u=m.html())),v(this).val().trim());null!=a&&((t={}).label=v(this).closest(".madxartwork-field-group").find(".madxartwork-field-label").html(),t.name=l.replace("[]","").replace("form_fields[","").replace("]",""),t.value=a,null!=f&&(t.value_multiple=f),t.type=v(this).attr("type"),void 0!==v(this).attr("data-pafe-form-builder-address-autocomplete")&&(t.lat=v(this).attr("data-pafe-form-builder-google-maps-lat"),t.lng=v(this).attr("data-pafe-form-builder-google-maps-lng"),t.zoom=v(this).attr("data-pafe-form-builder-google-maps-zoom")),""!=u&&(t.value_label=u),0<v(this).closest(".madxartwork-field-type-calculated_fields").length&&(t.calculation_results=v(this).val().trim()),0==v(this).closest(".pafe-form-builder-conditional-logic-hidden").length&&(t.repeater_id=d,t.repeater_id_one=n,t.repeater_label=s,t.repeater_index=o,t.repeater_length=e,null!=v(this).data("pafe-form-builder-remove-this-field-from-repeater")&&(t.repeater_remove_this_field="1"),b.push(t)))}}),a.append("action","pafe_ajax_form_builder_preview_submission"),a.append("fields",JSON.stringify(b)),null!=t.attr("data-pafe-form-builder-preview-submission-remove-empty-fields")&&a.append("remove_empty_fields",""),null!=t.attr("data-pafe-form-builder-preview-submission-custom-list-fields")&&a.append("custom_list_fields",t.attr("data-pafe-form-builder-preview-submission-custom-list-fields")),v.ajax({url:v("[data-pafe-ajax-url]").data("pafe-ajax-url"),type:"POST",data:a,processData:!1,contentType:!1,success:function(e){t.html(e)}})})}setTimeout(e(),1e3),v(document).on("keyup change","[data-pafe-form-builder-form-id]",v.debounce(250,function(){e()}))});